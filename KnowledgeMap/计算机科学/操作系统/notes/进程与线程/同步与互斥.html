<!doctype html>
<html style='font-size:22px !important'>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="../style.css">
<link rel="stylesheet" type="text/css" href="../../style.css">
<link rel="stylesheet" type="text/css" href="../../../style.css">
<link rel="stylesheet" type="text/css" href="../../../../style.css">
<link rel="stylesheet" type="text/css" href="../../../../../style.css"><title>同步与互斥</title>
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='同步与互斥'><span>同步与互斥</span></h1><p><span>2022.07.08</span></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" style="" href="#同步与互斥">同步与互斥</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n5"><a class="md-toc-inner" style="" href="#同步与互斥的基本概念">同步与互斥的基本概念</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n6"><a class="md-toc-inner" style="" href="#临界资源">临界资源</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n12"><a class="md-toc-inner" style="" href="#同步">同步</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n16"><a class="md-toc-inner" style="" href="#互斥">互斥</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n20"><a class="md-toc-inner" style="" href="#实现临界区互斥的基本方法">实现临界区互斥的基本方法</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n22"><a class="md-toc-inner" style="" href="#软件实现方法">软件实现方法</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n26"><a class="md-toc-inner" style="" href="#硬件实现方法">硬件实现方法</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n30"><a class="md-toc-inner" style="" href="#互斥锁">互斥锁</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n34"><a class="md-toc-inner" style="" href="#信号量">信号量</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n38"><a class="md-toc-inner" style="" href="#管程">管程</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n40"><a class="md-toc-inner" style="" href="#经典同步问题">经典同步问题</a></span></p></div><h2 id='同步与互斥的基本概念'><span>同步与互斥的基本概念</span></h2><p><span>在多道程序环境下，进程是并发执行的，不同进程之间存在着不同的相互制约关系。为了协调进程之间的相互制约关系，引入了进程同步的概念。下面举一个简单的例子来帮大家理解这个概念。例如，让系统计算 1+2×3，假设系统产生两个进程：一个是加法进程，一个是乘法进程。</span></p><p><span>要让计算结果是正确的，一定要让加法进程发生在乘法进程之后，但实际上操作系统具有异步性，若不加以制约，加法进程发生在乘法进程之前是绝对有可能的，因此要制定一定的机制去约束加法进程，让它在乘法进程完成之后才发生，而这种机制就是本节要讨论的内容。</span></p><h3 id='临界资源'><span>临界资源</span></h3><p><span>虽然多个进程可以共享系统中的各种资源，但其中许多资源一次只能为一个进程所用，我们将</span><u><span>一次仅允许一个进程使用的资源</span></u><span>称为</span><strong><span>临界资源</span></strong><span>。许多物理设备都属于临界资源，如打印机等。此外，还有许多变量、数据等都可以被若干进程共享，也属于临界资源。</span></p><p><u><span>对临界资源的访问，必须互斥地进行</span></u><span>，在每个进程中，</span><u><span>访问临界资源的那段代码</span></u><span>称为</span><strong><span>临界区</span></strong><span>。</span></p><p><span>为了保证临界资源的正确使用，可把临界资源的访问过程分成4个部分：</span></p><ul><li><strong><span>进入区</span></strong><span>。为了进入临界区使用临界资源，在进入区要</span><u><span>检查可否进入临界区</span></u><span>，若能进入临界区，则应</span><u><span>设置正在访问临界区的标志</span></u><span>，以阻止其他进程同时进入临界区。</span></li><li><strong><span>临界区</span></strong><span>。</span><u><span>进程中访问临界资源的那段代码，又称临界段</span></u><span>。</span></li><li><strong><span>退出区</span></strong><span>。将正在访问临界区的</span><u><span>标志清除</span></u><span>。</span></li><li><strong><span>剩余区</span></strong><span>。代码中的其余部分。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="c"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">do</span>{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">entry</span> <span class="cm-variable">section</span>; <span class="cm-comment">// 进入区<span class="cm-tab" role="presentation" cm-text="	"> </span></span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">critical</span> <span class="cm-variable">section</span>; <span class="cm-comment">// 临界区</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">exit</span> <span class="cm-variable">section</span>; <span class="cm-comment">// 退出区</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">reminderr</span> <span class="cm-variable">section</span>; <span class="cm-comment">// 剩余区</span></span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 168px;"></div><div class="CodeMirror-gutters" style="display: none; height: 168px;"></div></div></div></pre><h3 id='同步'><span>同步</span></h3><p><strong><span>同步</span></strong><span>亦称</span><strong><span>直接制约关系</span></strong><span>，是指为完成某种任务而建立的两个或多个进程，这些进程因为需要在某些位置上</span><u><span>协调它们的工作次序而等待、传递信息所产生的制约关系</span></u><span>。进程间的直接制约关系源于它们之间的相互合作。</span></p><p><span>例如，输入进程 A 通过单缓冲向进程B提供数据。当该缓冲区空时，进程B不能获得所需数据而阻塞，一旦进程 A 将数据送入缓冲区，进程B就被唤醒。反之，当缓冲区满时，进程 A被阻塞，仅当进程B取走缓冲数据时，才唤醒进程 A。</span></p><h3 id='互斥'><span>互斥</span></h3><p><strong><span>互斥</span></strong><span>也称</span><strong><span>间接制约关系</span></strong><span>。当一个进程进入临界区</span><u><span>使用临界资源</span></u><span>时，另一个进程必须等待，当占用临界资源的进程退出临界区后，另一进程才允许去访问此临界资源。</span></p><p><span>例如，在仅有一台打印机的系统中，有两个进程 A 和进程 B，若进程 A 需要打印时，系统己将打印机分配给进程 B，则进程 A 必须阻塞。一旦进程 B 将打印机释放，系统便将进程 A唤醒，并将其由阻塞态变为就绪态。</span></p><p><span>为禁止两个进程同时进入临界区，同步机制应遵循以下准则：</span></p><ul><li><strong><span>空闲让进</span></strong><span>。临界区空闲时，可以允许一个请求进入临界区的进程立即进入临界区。</span></li><li><strong><span>忙则等待</span></strong><span>。当己有进程进入临界区时，其他试图进入临界区的进程必须等待。</span></li><li><strong><span>有限等待</span></strong><span>。对请求访问的进程，应保证能在有限时间内进入临界区。</span></li><li><strong><span>让权等待</span></strong><span>。当进程不能进入临界区时，应立即释放处理器，防止进程忙等待</span></li></ul><h2 id='实现临界区互斥的基本方法'><span>实现临界区互斥的基本方法</span></h2><h3 id='软件实现方法'><span>软件实现方法</span></h3><p>&nbsp;</p><h3 id='硬件实现方法'><span>硬件实现方法</span></h3><p>&nbsp;</p><h2 id='互斥锁'><span>互斥锁</span></h2><p>&nbsp;</p><h2 id='信号量'><span>信号量</span></h2><p>&nbsp;</p><h2 id='管程'><span>管程</span></h2><p>&nbsp;</p><h2 id='经典同步问题'><span>经典同步问题</span></h2><p>&nbsp;</p></div></div>
</body>
</html>