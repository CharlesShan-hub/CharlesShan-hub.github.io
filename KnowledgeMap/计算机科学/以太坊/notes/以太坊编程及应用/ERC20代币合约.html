<!doctype html>
<html style='font-size:19px !important'>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap' rel='stylesheet' type='text/css' /><link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="../style.css">
<link rel="stylesheet" type="text/css" href="../../style.css">
<link rel="stylesheet" type="text/css" href="../../../style.css">
<link rel="stylesheet" type="text/css" href="../../../../style.css">
<link rel="stylesheet" type="text/css" href="../../../../../style.css"><title>ERC20代币合约</title>
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='erc20代币合约'><span>ERC20代币合约</span></h1><p><span>2022.2.20</span></p><h2 id='源码粘贴'><span>源码粘贴</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="solidity" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="solidity"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.5px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">pragma</span> <span class="cm-variable">solidity</span> <span class="cm-operator">^</span><span class="cm-number">0.4.16</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">interface</span> <span class="cm-def">tokenRecipient</span> { </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">function</span> <span class="cm-def">receiveApproval</span>(<span class="cm-type">address</span> <span class="cm-variable">_from</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>, <span class="cm-type">address</span> <span class="cm-variable">_token</span>, <span class="cm-type">bytes</span> <span class="cm-variable">_extraData</span>) <span class="cm-keyword">external</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">contract</span> <span class="cm-def">TokenERC20</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Public variables of the token</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">string</span> <span class="cm-keyword">public</span> <span class="cm-variable">name</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">string</span> <span class="cm-keyword">public</span> <span class="cm-variable">symbol</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">uint8</span> <span class="cm-keyword">public</span> <span class="cm-variable">decimals</span> <span class="cm-operator">=</span> <span class="cm-number">18</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 18 decimals is the strongly suggested default, avoid changing it </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">uint256</span> <span class="cm-keyword">public</span> <span class="cm-variable">totalSupply</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This creates an array with all balances</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">mapping</span> (<span class="cm-type">address</span> <span class="cm-operator">=&gt;</span> <span class="cm-type">uint256</span>) <span class="cm-def">public</span> <span class="cm-variable">balanceOf</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">mapping</span> (<span class="cm-type">address</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">mapping</span> (<span class="cm-type">address</span> <span class="cm-operator">=&gt;</span> <span class="cm-type">uint256</span>)) <span class="cm-def">public</span> <span class="cm-variable">allowance</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This generates a public event on the blockchain that will notify clients </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">event</span> <span class="cm-def">Transfer</span>(<span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">from</span>, <span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">to</span>, <span class="cm-type">uint256</span> <span class="cm-variable">value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This generates a public event on the blockchain that will notify clients</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">event</span> <span class="cm-def">Approval</span>(<span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">_owner</span>, <span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">_spender</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This notifies clients about the amount burnt </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">event</span> <span class="cm-def">Burn</span>(<span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">from</span>, <span class="cm-type">uint256</span> <span class="cm-variable">value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-comment">*</span> <span class="cm-comment">Constructor function</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-comment">*</span> <span class="cm-comment">Initializes contract with initial supply tokens to the creator of the contract </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">function</span> <span class="cm-def">TokenERC20</span>( <span class="cm-type">uint256</span> <span class="cm-variable">initialSupply</span>, <span class="cm-type">string</span> <span class="cm-variable">tokenName</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">string</span> <span class="cm-variable">tokenSymbol</span> ) <span class="cm-keyword">public</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">totalSupply</span> <span class="cm-operator">=</span> <span class="cm-variable">initialSupply</span> <span class="cm-operator">*</span> <span class="cm-number">10</span> <span class="cm-operator">**</span> <span class="cm-type">uint256</span>(<span class="cm-variable">decimals</span>); <span class="cm-comment">//Update total supply with the decimal amount</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">balanceOf</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">=</span> <span class="cm-variable">totalSupply</span>; <span class="cm-comment">// Give the creator all initial tokens</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">name</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenName</span>; <span class="cm-comment">// Set the name for display purposes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">symbol</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenSymbol</span>; <span class="cm-comment">// Set the symbol for display purposes </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-comment">*</span> <span class="cm-comment">Internal transfer, only can be called by this contract </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">function</span> <span class="cm-def">_transfer</span>(<span class="cm-type">address</span> <span class="cm-variable">_from</span>, <span class="cm-type">address</span> <span class="cm-variable">_to</span>, <span class="cm-type">uint</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">internal</span> { </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// Prevent transfer to 0x0 address. Use burn() instead </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">require</span>(<span class="cm-variable">_to</span> <span class="cm-operator">!=</span> <span class="cm-number">0x0</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Check if the sender has enough</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">&gt;=</span> <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Check for overflows</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>] <span class="cm-operator">+</span> <span class="cm-variable">_value</span> <span class="cm-operator">&gt;=</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>]); <span class="cm-comment">// Save this for an assertion in the future</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">uint</span> <span class="cm-variable">previousBalances</span> <span class="cm-operator">=</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">+</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>]; <span class="cm-comment">// Subtract from the sender</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Add the same to the recipient</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>] <span class="cm-operator">+=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">emit</span> <span class="cm-variable">Transfer</span>(<span class="cm-variable">_from</span>, <span class="cm-variable">_to</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Asserts are used to use static analysis to find bugs in your code. They should never fail</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">assert</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">+</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>] <span class="cm-operator">==</span> <span class="cm-variable">previousBalances</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Transfer tokens </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Send `_value` tokens to `_to` from your account </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_to The address of the recipient</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount to send </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">function</span> <span class="cm-def">transfer</span>(<span class="cm-type">address</span> <span class="cm-variable">_to</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) { </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">_transfer</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_to</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-atom">true</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Transfer tokens from other address </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Send `_value` tokens to `_to` on behalf of `_from`</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_from The address of the sender </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_to The address of the recipient </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount to send</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">function</span> <span class="cm-def">transferFrom</span>(<span class="cm-type">address</span> <span class="cm-variable">_from</span>, <span class="cm-type">address</span> <span class="cm-variable">_to</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">_value</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>]); <span class="cm-comment">// Check allowance </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">_transfer</span>(<span class="cm-variable">_from</span>, <span class="cm-variable">_to</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-atom">true</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Set allowance for other address </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Allows `_spender` to spend no more than `_value` tokens on your behalf </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_spender The address authorized to spend</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the max amount they can spend </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">function</span> <span class="cm-def">approve</span>(<span class="cm-type">address</span> <span class="cm-variable">_spender</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">allowance</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>][<span class="cm-variable">_spender</span>] <span class="cm-operator">=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">emit</span> <span class="cm-variable">Approval</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_spender</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">return</span> <span class="cm-atom">true</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Set allowance for other address and notify</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Allows `_spender` to spend no more than `_value` tokens on your behalf, and then ping</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">the contract about it </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_spender The address authorized to spend</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the max amount they can spend</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_extraData some extra information to send to the approved contract</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">function</span> <span class="cm-def">approveAndCall</span>(<span class="cm-type">address</span> <span class="cm-variable">_spender</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>, <span class="cm-type">bytes</span> <span class="cm-variable">_extraData</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tokenRecipient</span> <span class="cm-variable">spender</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenRecipient</span>(<span class="cm-variable">_spender</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable">approve</span>(<span class="cm-variable">_spender</span>, <span class="cm-variable">_value</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">spender</span>.<span class="cm-variable">receiveApproval</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_value</span>, <span class="cm-keyword">this</span>, <span class="cm-variable">_extraData</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">return</span> <span class="cm-atom">true</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Destroy tokens </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-comment">Remove `_value` tokens from the system irreversibly </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount of money to burn</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">function</span> <span class="cm-def">burn</span>(<span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// Check if the sender has enough</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">&gt;=</span> <span class="cm-variable">_value</span>); </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// Subtract from the sender</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">balanceOf</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// Updates totalSupply</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">totalSupply</span> <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">emit</span> <span class="cm-variable">Burn</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  <span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">return</span> <span class="cm-atom">true</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">*</span> <span class="cm-comment">Destroy tokens from other account </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">*</span> <span class="cm-comment">Remove `_value` tokens from the system irreversibly on behalf of `_from`. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_from the address of the sender</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount of money to burn</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-keyword">function</span> <span class="cm-def">burnFrom</span>(<span class="cm-type">address</span> <span class="cm-variable">_from</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-comment">// Check if the targeted balance is enough </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">&gt;=</span> <span class="cm-variable">_value</span>); </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Check allowance</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">_value</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>]);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Subtract from the targeted balance</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Subtract from the sender's allowance</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Update totalSupply</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">totalSupply</span> <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">emit</span> <span class="cm-variable">Burn</span>(<span class="cm-variable">_from</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-atom">true</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 4590px;"></div><div class="CodeMirror-gutters" style="display: none; height: 4590px;"></div></div></div></pre><h2 id='分析------合约的变量'><span>分析——合约的变量</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="solidity" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="solidity"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.5px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">contract</span> <span class="cm-def">TokenERC20</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// Public variables of the token</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">string</span> <span class="cm-keyword">public</span> <span class="cm-variable">name</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">string</span> <span class="cm-keyword">public</span> <span class="cm-variable">symbol</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">uint8</span> <span class="cm-keyword">public</span> <span class="cm-variable">decimals</span> <span class="cm-operator">=</span> <span class="cm-number">18</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 18 decimals is the strongly suggested default, avoid changing it </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-type">uint256</span> <span class="cm-keyword">public</span> <span class="cm-variable">totalSupply</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This creates an array with all balances</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">mapping</span> (<span class="cm-type">address</span> <span class="cm-operator">=&gt;</span> <span class="cm-type">uint256</span>) <span class="cm-def">public</span> <span class="cm-variable">balanceOf</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">mapping</span> (<span class="cm-type">address</span> <span class="cm-operator">=&gt;</span> <span class="cm-keyword">mapping</span> (<span class="cm-type">address</span> <span class="cm-operator">=&gt;</span> <span class="cm-type">uint256</span>)) <span class="cm-def">public</span> <span class="cm-variable">allowance</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This generates a public event on the blockchain that will notify clients </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">event</span> <span class="cm-def">Transfer</span>(<span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">from</span>, <span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">to</span>, <span class="cm-type">uint256</span> <span class="cm-variable">value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This generates a public event on the blockchain that will notify clients</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">event</span> <span class="cm-def">Approval</span>(<span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">_owner</span>, <span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">_spender</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// This notifies clients about the amount burnt </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">event</span> <span class="cm-def">Burn</span>(<span class="cm-type">address</span> <span class="cm-keyword">indexed</span> <span class="cm-variable">from</span>, <span class="cm-type">uint256</span> <span class="cm-variable">value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">//......</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 621px;"></div><div class="CodeMirror-gutters" style="display: none; height: 621px;"></div></div></div></pre><ul><li><code>name</code><span> 和 </span><code>symbol</code><span> 是要发行货币的名字与代称，比如假如比特币用这个合约的话，name就是比热币，symbol就是BTC。</span></li><li><code>decimals</code><span> 规定了小数点精确位数。默认是18，最好不要修改。</span></li><li><code>totalSupply</code><span> 是一共发行的货币。</span></li><li><code>balanceOf</code><span> 是某个账户的余额。</span></li><li><code>allowance</code><span> 授权额度。代表了别人用这个账户可以转账的额度。</span></li><li><code>mapping (address =&gt; mapping (address =&gt; uint256))</code><span> 中的第一个mapping保存了每一个用户对其他用户的授权信息，第二个mapping保存了某个用户对各个用户的授权信息。</span></li><li><code>Transfer</code><span>,</span><code>Approval</code><span>,</span><code>Burn</code><span> 是转移，同意和销毁代币的事件。</span></li></ul><h2 id='分析------构造函数'><span>分析——构造函数</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="solidity" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="solidity"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.5px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Constructor function</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Initializes contract with initial supply tokens to the creator of the contract </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">TokenERC20</span>( </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-type">uint256</span> <span class="cm-variable">initialSupply</span>, </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-type">string</span> <span class="cm-variable">tokenName</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-type">string</span> <span class="cm-variable">tokenSymbol</span> ) <span class="cm-keyword">public</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">//Update total supply with the decimal amount</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">totalSupply</span> <span class="cm-operator">=</span> <span class="cm-variable">initialSupply</span> <span class="cm-operator">*</span> <span class="cm-number">10</span> <span class="cm-operator">**</span> <span class="cm-type">uint256</span>(<span class="cm-variable">decimals</span>); </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// Give the creator all initial tokens</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">balanceOf</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">=</span> <span class="cm-variable">totalSupply</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// Set the name for display purposes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">name</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenName</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-comment">// Set the symbol for display purposes </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">symbol</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenSymbol</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 486px;"></div><div class="CodeMirror-gutters" style="display: none; height: 486px;"></div></div></div></pre><ul><li><span>ERC20称为一个标准，需要允许各种代币通过它进行创建，所以代币名称与代称是传入的参数，而不是在源代码里边写死了，然后每个人新创建代币的时候都重新改源代码。</span></li><li><code>totalSupply = initialSupply * 10 ** uint256(decimals);</code><span>因为浮点类型的数容易造成缺失，所以把它转化成了整型的。</span></li><li><code>balanceOf[msg.sender] = totalSupply;</code><span>创建者拥有一些代币的控制权。</span></li></ul><h2 id='分析------转账'><span>分析——转账</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="solidity" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="solidity"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.5px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Internal transfer, only can be called by this contract </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">_transfer</span>(<span class="cm-type">address</span> <span class="cm-variable">_from</span>, <span class="cm-type">address</span> <span class="cm-variable">_to</span>, <span class="cm-type">uint</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">internal</span> { </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// Prevent transfer to 0x0 address. Use burn() instead </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">_to</span> <span class="cm-operator">!=</span> <span class="cm-number">0x0</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// Check if the sender has enough</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">&gt;=</span> <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// Check for overflows</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>] <span class="cm-operator">+</span> <span class="cm-variable">_value</span> <span class="cm-operator">&gt;=</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>]); <span class="cm-comment">// Save this for an assertion in the future</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-type">uint</span> <span class="cm-variable">previousBalances</span> <span class="cm-operator">=</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">+</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>];</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// Subtract from the sender</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// Add the same to the recipient</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>] <span class="cm-operator">+=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">emit</span> <span class="cm-variable">Transfer</span>(<span class="cm-variable">_from</span>, <span class="cm-variable">_to</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">// Asserts are used to use static analysis to find bugs in your code. They should never fail</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">assert</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">+</span> <span class="cm-variable">balanceOf</span>[<span class="cm-variable">_to</span>] <span class="cm-operator">==</span> <span class="cm-variable">previousBalances</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Transfer tokens </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Send `_value` tokens to `_to` from your account </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_to The address of the recipient</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount to send </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">transfer</span>(<span class="cm-type">address</span> <span class="cm-variable">_to</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) { </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">_transfer</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_to</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> <span class="cm-atom">true</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Transfer tokens from other address </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Send `_value` tokens to `_to` on behalf of `_from`</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_from The address of the sender </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_to The address of the recipient </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount to send</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">transferFrom</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-type">address</span> <span class="cm-variable">_from</span>, </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-type">address</span> <span class="cm-variable">_to</span>, </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">require</span>(<span class="cm-variable">_value</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>]); <span class="cm-comment">// Check allowance </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">_transfer</span>(<span class="cm-variable">_from</span>, <span class="cm-variable">_to</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-atom">true</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1431px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1431px;"></div></div></div></pre><ul><li><p><code>_transfer</code><span>函数</span></p><ul><li><code>_transfer</code><span>:前边加了一个“_”，说明只能在合约内部调用</span></li></ul></li><li><p><code>transfer</code><span>函数</span></p><ul><li><code>require(_to != 0x0);</code><span> 不能向0地址转币，如果要销毁代币需要用brun方法。</span></li><li><code>require(balanceOf[_to] + _value &gt;= balanceOf[_to]);</code><span>防止加法溢出。</span></li><li><code>previousBalances</code><span>记录了交易前，发送方与接收方账户代币的总和，在进行余额加减运算后进行</span><code>assert(balanceOf[_from] + balanceOf[_to] == previousBalances);</code><span>（断言），来保证转账过程的原子性（确定中间不出啥幺蛾子）。</span></li></ul></li><li><p><code>transferFrom</code><span>函数：这个就是允许别人转这个账户的钱。</span></p><ul><li><p><code>allowance</code><span>是</span><code>mapping (address =&gt; mapping (address =&gt; uint256))</code></p><p><code>allowance[_from][msg.sender]</code><span>是本账户允许另一账户A(</span><code>_from</code><span>)操控自己转币的上限。</span></p></li></ul></li></ul><h2 id='分析------批准'><span>分析——批准</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="solidity" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="solidity"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.5px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">interface</span> <span class="cm-def">tokenRecipient</span> { </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-keyword">function</span> <span class="cm-def">receiveApproval</span>(<span class="cm-type">address</span> <span class="cm-variable">_from</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>, <span class="cm-type">address</span> <span class="cm-variable">_token</span>, <span class="cm-type">bytes</span> <span class="cm-variable">_extraData</span>) <span class="cm-keyword">external</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Set allowance for other address </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Allows `_spender` to spend no more than `_value` tokens on your behalf </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_spender The address authorized to spend</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the max amount they can spend </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">approve</span>(<span class="cm-type">address</span> <span class="cm-variable">_spender</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">allowance</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>][<span class="cm-variable">_spender</span>] <span class="cm-operator">=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">emit</span> <span class="cm-variable">Approval</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_spender</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> <span class="cm-atom">true</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Set allowance for other address and notify</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Allows `_spender` to spend no more than `_value` tokens on your behalf, and then ping</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">the contract about it </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_spender The address authorized to spend</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the max amount they can spend</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_extraData some extra information to send to the approved contract</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">approveAndCall</span>(<span class="cm-type">address</span> <span class="cm-variable">_spender</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>, <span class="cm-type">bytes</span> <span class="cm-variable">_extraData</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tokenRecipient</span> <span class="cm-variable">spender</span> <span class="cm-operator">=</span> <span class="cm-variable">tokenRecipient</span>(<span class="cm-variable">_spender</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> (<span class="cm-variable">approve</span>(<span class="cm-variable">_spender</span>, <span class="cm-variable">_value</span>)) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">spender</span>.<span class="cm-variable">receiveApproval</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_value</span>, <span class="cm-keyword">this</span>, <span class="cm-variable">_extraData</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">return</span> <span class="cm-atom">true</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1026px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1026px;"></div></div></div></pre><ul><li><code>approve</code><span>，给</span><code>_spender</code><span>授权了</span><code>_value</code><span>的额度。</span></li></ul><h2 id='分析------销毁'><span>分析——销毁</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="solidity" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="solidity"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11.5px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Destroy tokens </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Remove `_value` tokens from the system irreversibly </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount of money to burn</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">burn</span>(<span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Check if the sender has enough</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">&gt;=</span> <span class="cm-variable">_value</span>); </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Subtract from the sender</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">balanceOf</span>[<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Updates totalSupply</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">totalSupply</span> <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">emit</span> <span class="cm-variable">Burn</span>(<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">return</span> <span class="cm-atom">true</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Destroy tokens from other account </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-comment">Remove `_value` tokens from the system irreversibly on behalf of `_from`. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_from the address of the sender</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*</span> <span class="cm-tag">@param</span> <span class="cm-comment">_value the amount of money to burn</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-def">burnFrom</span>(<span class="cm-type">address</span> <span class="cm-variable">_from</span>, <span class="cm-type">uint256</span> <span class="cm-variable">_value</span>) <span class="cm-keyword">public</span> <span class="cm-keyword">returns</span> (<span class="cm-type">bool</span> <span class="cm-variable">success</span>) {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Check if the targeted balance is enough </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">require</span>(<span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">&gt;=</span> <span class="cm-variable">_value</span>); </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Check allowance</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">require</span>(<span class="cm-variable">_value</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>]);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Subtract from the targeted balance</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">balanceOf</span>[<span class="cm-variable">_from</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Subtract from the sender's allowance</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">allowance</span>[<span class="cm-variable">_from</span>][<span class="cm-keyword">msg</span>.<span class="cm-keyword">sender</span>] <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Update totalSupply</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">totalSupply</span> <span class="cm-operator">-=</span> <span class="cm-variable">_value</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">emit</span> <span class="cm-variable">Burn</span>(<span class="cm-variable">_from</span>, <span class="cm-variable">_value</span>);</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">return</span> <span class="cm-atom">true</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1107px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1107px;"></div></div></div></pre><p>&nbsp;</p></div></div>
</body>
</html>